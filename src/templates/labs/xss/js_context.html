{% extends 'labs/xss/xss_lab_base.html' %}

{% block title %}JavaScript Context XSS - Django Goat{% endblock %}

{% block lab_content %}
<div class="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-8">
    <h2 class="text-xl font-bold text-white mb-4">User Profile</h2>
    <form method="GET" action="" class="mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
                <label for="username" class="block text-slate-300 mb-2">Username:</label>
                <input type="text" id="username" name="username" value="{{ request.GET.username|default:'' }}"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white"
                    placeholder="Enter username">
            </div>
            <div>
                <label for="status" class="block text-slate-300 mb-2">Status Message:</label>
                <input type="text" id="status" name="status" value="{{ request.GET.status|default:'' }}"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white"
                    placeholder="What's on your mind?">
            </div>
        </div>
        <button type="submit"
            class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
            Update Profile
        </button>
    </form>

    <div class="bg-slate-900 rounded-lg p-6 border border-slate-700">
        <h3 class="text-lg font-semibold text-white mb-4">Profile Preview</h3>
        <div class="flex items-center space-x-4 mb-4">
            <div class="w-16 h-16 bg-slate-700 rounded-full flex items-center justify-center">
                <i data-lucide="user" class="h-8 w-8 text-slate-400"></i>
            </div>
            <div>
                <h4 class="text-xl font-semibold text-white" id="displayUsername">
                    {{ request.GET.username|default:'Anonymous User'|safe }}
                </h4>
                <p class="text-slate-300" id="displayStatus">
                    {{ request.GET.status|default:'No status set'|safe }}
                </p>
            </div>
        </div>

        <button onclick="showUserInfo()"
            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
            Show User Info
        </button>
    </div>

    <div class="mt-6">
        <h3 class="text-lg font-semibold text-white mb-4">Try These Examples</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <a href="?username=JohnDoe&status=Hello World!"
                class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                <span class="text-slate-300">Normal profile</span>
            </a>
            <a href="?username=TestUser&status=I'm learning JavaScript!"
                class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                <span class="text-slate-300">Profile with apostrophe</span>
            </a>
            <a href="?username=&status="
                class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                <span class="text-slate-300">Empty profile</span>
            </a>
            <a href="?username=User123&status=Status with \" quotes\""
                class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                <span class="text-slate-300">Profile with quotes</span>
            </a>
        </div>
    </div>
</div>

{% endblock %}

{% block lab_js %}
<script>
    // Vulnerable JavaScript code - user input embedded directly
    var username = "{{ request.GET.username|default:'Anonymous User'|safe }}";
    var status = "{{ request.GET.status|default:'No status set'|safe }}";

    function showUserInfo() {
        alert("User: " + username + "\nStatus: " + status);
    }
</script>
{% endblock %}