{% extends 'labs/xss/xss_lab_base.html' %}

{% block title %}Form Input XSS - Django Goat{% endblock %}

{% block lab_content %}
<div class="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-8">
    <h2 class="text-xl font-bold text-white mb-4">Contact Form</h2>
    <form method="POST" action="" class="mb-6">
        {% csrf_token %}
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
                <label for="first_name" class="block text-slate-300 mb-2">First Name:</label>
                <input type="text" id="first_name" name="first_name"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white">
            </div>
            <div>
                <label for="last_name" class="block text-slate-300 mb-2">Last Name:</label>
                <input type="text" id="last_name" name="last_name"
                    class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white">
            </div>
        </div>
        <div class="mb-4">
            <label for="email" class="block text-slate-300 mb-2">Email:</label>
            <input type="email" id="email" name="email"
                class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white">
        </div>
        <div class="mb-4">
            <label for="subject" class="block text-slate-300 mb-2">Subject:</label>
            <input type="text" id="subject" name="subject"
                class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white">
        </div>
        <div class="mb-4">
            <label for="message" class="block text-slate-300 mb-2">Message:</label>
            <textarea id="message" name="message" rows="4"
                class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white"></textarea>
        </div>
        <button type="submit" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors">
            Send Message
        </button>
    </form>

    {% if request.method == 'POST' %}
    <div class="bg-slate-900 rounded-lg p-4 border border-slate-700">
        <h3 class="text-lg font-semibold text-white mb-4">Form Submission Received</h3>
        <div class="space-y-2">
            {% if request.POST.first_name %}
            <!-- Vulnerable code: Directly inserting form input without sanitization -->
            <p class="text-slate-300"><strong>First Name:</strong> {{ request.POST.first_name|safe }}</p>
            {% endif %}
            {% if request.POST.last_name %}
            <p class="text-slate-300"><strong>Last Name:</strong> {{ request.POST.last_name|safe }}</p>
            {% endif %}
            {% if request.POST.email %}
            <p class="text-slate-300"><strong>Email:</strong> {{ request.POST.email|safe }}</p>
            {% endif %}
            {% if request.POST.subject %}
            <p class="text-slate-300"><strong>Subject:</strong> {{ request.POST.subject|safe }}</p>
            {% endif %}
            {% if request.POST.message %}
            <p class="text-slate-300"><strong>Message:</strong> {{ request.POST.message|safe }}</p>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
