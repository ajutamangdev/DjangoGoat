{% extends 'labs/xss/xss_lab_base.html' %}

{% block title %}HTML Attribute XSS - Django Goat{% endblock %}

{% block lab_content %}
            <div class="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-8">
                <h2 class="text-xl font-bold text-white mb-4">Image Gallery</h2>
                <form method="GET" action="" class="mb-6">
                    <div class="mb-4">
                        <label for="title" class="block text-slate-300 mb-2">Image Title:</label>
                        <input type="text" id="title" name="title" value="{{ request.GET.title|default:'' }}" 
                               class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white"
                               placeholder="Enter image title">
                    </div>
                    <div class="mb-4">
                        <label for="alt" class="block text-slate-300 mb-2">Alt Text:</label>
                        <input type="text" id="alt" name="alt" value="{{ request.GET.alt|default:'' }}" 
                               class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white"
                               placeholder="Enter alt text">
                    </div>
                    <button type="submit" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
                        Update Image
                    </button>
                </form>

                <div class="bg-slate-900 rounded-lg p-6 border border-slate-700">
                    <h3 class="text-lg font-semibold text-white mb-4">Image Preview</h3>
                    <!-- Vulnerable code: User input directly in HTML attributes -->
                    <img src="/static/images/placeholder.jpg" 
                         title="{{ request.GET.title|default:'Sample Image'|safe }}" 
                         alt="{{ request.GET.alt|default:'Placeholder image'|safe }}"
                         class="w-full max-w-md h-48 object-cover rounded-lg border border-slate-700 bg-slate-800">
                    
                    <div class="mt-4 space-y-2">
                        <p class="text-slate-300"><strong>Title:</strong> {{ request.GET.title|default:'Sample Image'|safe }}</p>
                        <p class="text-slate-300"><strong>Alt Text:</strong> {{ request.GET.alt|default:'Placeholder image'|safe }}</p>
                    </div>
                </div>

                <div class="mt-6">
                    <h3 class="text-lg font-semibold text-white mb-4">Try These Examples</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <a href="?title=Beautiful Sunset&alt=A sunset over mountains" 
                           class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                            <span class="text-slate-300">Normal image attributes</span>
                        </a>
                        <a href="?title=Test Image&alt=" 
                           class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                            <span class="text-slate-300">Empty alt attribute</span>
                        </a>
                        <a href="?title=&alt=Sample alt text" 
                           class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                            <span class="text-slate-300">Empty title attribute</span>
                        </a>
                        <a href="?title=Image with quotes&alt=Alt with 'quotes'" 
                           class="bg-slate-900 hover:bg-slate-700 p-3 rounded-lg border border-slate-700 transition-colors">
                            <span class="text-slate-300">Attributes with quotes</span>
                        </a>
                    </div>
                </div>
            </div>

{% endblock %}