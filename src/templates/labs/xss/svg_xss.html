{% extends 'labs/xss/xss_lab_base.html' %}

{% block title %}SVG XSS - Django Goat{% endblock %}

{% block lab_content %}
<div class="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-8">
    <h2 class="text-xl font-bold text-white mb-4">SVG Renderer</h2>
    <form method="POST" action="" class="mb-6">
        {% csrf_token %}
        <div class="mb-4">
            <label for="svg_content" class="block text-slate-300 mb-2">SVG Content:</label>
            <textarea id="svg_content" name="svg_content" rows="8"
                class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white font-mono text-sm"
                placeholder="Enter SVG markup here...">{{ request.POST.svg_content|default:'<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
  <circle cx="50" cy="50" r="40" fill="red" />
  <text x="50" y="55" text-anchor="middle" fill="white">SVG</text>
</svg>' }}</textarea>
        </div>
        <button type="submit"
            class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
            Render SVG
        </button>
    </form>

    {% if request.method == 'POST' and request.POST.svg_content %}
    <div class="bg-slate-900 rounded-lg p-6 border border-slate-700">
        <h3 class="text-lg font-semibold text-white mb-4">Rendered SVG</h3>
        <div class="bg-white p-4 rounded-lg border-2 border-dashed border-slate-600 mb-4">
            <!-- Vulnerable: Directly rendering user SVG content -->
            {{ request.POST.svg_content|safe }}
        </div>
        <div class="text-xs text-slate-400">
            <strong>Note:</strong> SVG content is rendered directly without sanitization
        </div>
    </div>
    {% endif %}

    <div class="mt-6">
        <h3 class="text-lg font-semibold text-white mb-4">SVG Examples</h3>
        <div class="grid grid-cols-1 gap-4">
            <div class="bg-slate-900 p-3 rounded-lg border border-slate-700">
                <p class="text-slate-300 text-sm mb-2">Basic SVG Circle:</p>
                <code
                    class="text-green-400 text-xs block">&lt;svg width="100" height="100"&gt;&lt;circle cx="50" cy="50" r="40" fill="blue"/&gt;&lt;/svg&gt;</code>
            </div>
            <div class="bg-slate-900 p-3 rounded-lg border border-slate-700">
                <p class="text-slate-300 text-sm mb-2">SVG with Animation:</p>
                <code
                    class="text-yellow-400 text-xs block">&lt;svg&gt;&lt;rect width="100" height="100"&gt;&lt;animate attributeName="fill" values="red;blue;red" dur="2s" repeatCount="indefinite"/&gt;&lt;/rect&gt;&lt;/svg&gt;</code>
            </div>
            <div class="bg-slate-900 p-3 rounded-lg border border-slate-700">
                <p class="text-slate-300 text-sm mb-2">SVG with Script (Dangerous):</p>
                <code
                    class="text-red-400 text-xs block">&lt;svg onload="alert('XSS')"&gt;&lt;rect width="100" height="100"/&gt;&lt;/svg&gt;</code>
            </div>
        </div>
    </div>
</div>

{% endblock %}